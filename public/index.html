<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SV Quick · Takipçi Sayısı</title>
  <style>
    body{font-family:ui-sans-serif,-apple-system,Segoe UI,Roboto; margin:0; background:#0b1220; color:#e6e9ef}
    .wrap{max-width:760px;margin:40px auto;padding:0 16px}
    .card{background:#101a2c;border:1px solid #1f2b44;border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:0 0 10px;font-size:22px}
    .muted{color:#9db0c8;font-size:13px;margin-bottom:12px}
    .row{display:grid;grid-template-columns:1fr auto;gap:8px}
    input{width:100%;padding:14px;border-radius:12px;border:1px solid #26334f;background:#0e1626;color:#e6e9ef}
    button{padding:14px 18px;border-radius:12px;border:1px solid #2b7cff;background:#2b7cff;color:#fff;font-weight:700;cursor:pointer}
    table{width:100%;border-collapse:separate;border-spacing:0 8px;margin-top:14px}
    th,td{padding:12px 14px;text-align:left;background:#0b1426;border:1px solid #24304a}
    th:first-child,td:first-child{border-top-left-radius:10px;border-bottom-left-radius:10px}
    th:last-child,td:last-child{border-top-right-radius:10px;border-bottom-right-radius:10px}
    .right{text-align:right}
    .status{margin-top:10px;font-size:13px;color:#9db0c8}
  </style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>SV Quick · Takipçi Sayısı</h1>
    <div class="muted">
      Boşluğa veya virgülle birden çok ad yaz: <b>bbc odakreport stargazete</b>.<br>
      Varsayılan platform <b>Instagram</b>. Facebook için <b>facebook:@sayfa</b> yaz.<br>
      <i>Yalnızca takipçi sayısını getirir.</i>
    </div>
    <div class="row">
      <input id="handles" placeholder="örn: bbc odakreport facebook:@bbcturkce">
      <button id="go">Getir</button>
    </div>
    <div id="status" class="status"></div>
    <table id="tbl" style="display:none">
      <thead>
        <tr><th>Handle</th><th>Platform</th><th class="right">Takipçi</th><th>Kaynak</th></tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>
</div>

<script>
function normTokens(s){
  return (s||"").trim().split(/[,\s]+/).filter(Boolean).slice(0,25);
}
function fmt(n){ return n==null?"—":Number(n).toLocaleString('tr-TR'); }

async function fetchFollowers(tokens){
  const list = encodeURIComponent(tokens.join(","));
  const r = await fetch("/.netlify/functions/followers?list="+list);
  if(!r.ok) throw new Error("HTTP "+r.status);
  return await r.json();
}
async function run(){
  const input = document.getElementById('handles').value;
  const tokens = normTokens(input);
  if(tokens.length===0){
    document.getElementById('status').textContent = "Önce bir veya daha fazla ad yaz.";
    return;
  }
  document.getElementById('status').textContent = "Çekiliyor…";
  const tbody = document.getElementById('tbody'); tbody.innerHTML="";
  document.getElementById('tbl').style.display="table";
  try{
    const j = await fetchFollowers(tokens);
    document.getElementById('status').textContent = "";
    for(const it of j.items){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${it.handle}</td>
        <td>${it.platform}</td>
        <td class="right">${fmt(it.followers)}</td>
        <td>${it.source||"—"}</td>`;
      tbody.appendChild(tr);
    }
  }catch(e){
    document.getElementById('status').textContent = "Hata: "+e.message;
  }
}
document.getElementById('go').addEventListener('click', run);
document.getElementById('handles').addEventListener('keypress', (e)=>{ if(e.key==='Enter'){ run(); }});
</script>
</body>
</html>
